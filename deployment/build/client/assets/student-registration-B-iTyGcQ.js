var Pe=i=>{throw TypeError(i)};var Be=(i,r,s)=>r.has(i)||Pe("Cannot "+s);var S=(i,r,s)=>(Be(i,r,"read from private field"),s?s.call(i):r.get(i)),k=(i,r,s)=>r.has(i)?Pe("Cannot add the same private member more than once"):r instanceof WeakSet?r.add(i):r.set(i,s),D=(i,r,s,e)=>(Be(i,r,"write to private field"),e?e.call(i,s):r.set(i,s),s);var ze=(i,r,s,e)=>({set _(t){D(i,r,t,s)},get _(){return S(i,r,e)}});import{r as Xe,b as J,t as A}from"./index-BozS7dwg.js";import{u as it,d as xe,s as rt,l as at}from"./useMutation-D7hWThM1.js";import{i as ye}from"./chunk-SSA7SXE4-L4GPux4n.js";import{b as nt}from"./chunk-WBUKVQRU-D83Npybh.js";var pe={exports:{}},Ve={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ne;function ot(){if(Ne)return Ve;Ne=1;var i=Xe();function r(d,o){return d===o&&(d!==0||1/d===1/o)||d!==d&&o!==o}var s=typeof Object.is=="function"?Object.is:r,e=i.useState,t=i.useEffect,a=i.useLayoutEffect,n=i.useDebugValue;function l(d,o){var m=o(),f=e({inst:{value:m,getSnapshot:o}}),v=f[0].inst,g=f[1];return a(function(){v.value=m,v.getSnapshot=o,c(v)&&g({inst:v})},[d,m,o]),t(function(){return c(v)&&g({inst:v}),d(function(){c(v)&&g({inst:v})})},[d]),n(m),m}function c(d){var o=d.getSnapshot;d=d.value;try{var m=o();return!s(d,m)}catch{return!0}}function u(d,o){return o()}var h=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?u:l;return Ve.useSyncExternalStore=i.useSyncExternalStore!==void 0?i.useSyncExternalStore:h,Ve}var Ue;function lt(){return Ue||(Ue=1,pe.exports=ot()),pe.exports}const zt=[{id:"1",name:"Juan PÃ©rez GarcÃ­a",email:"juan.perez@escuelaing.edu.co",role:"STUDENT"},{id:"2",name:"MarÃ­a GonzÃ¡lez LÃ³pez",email:"maria.gonzalez@escuelaing.edu.co",role:"DEAN"},{id:"3",name:"Carlos RodrÃ­guez Silva",email:"carlos.rodriguez@escuelaing.edu.co",role:"ADMIN"},{id:"4",name:"Ana MartÃ­nez Torres",email:"ana.martinez@escuelaing.edu.co",role:"STUDENT"}],ut=()=>`RAD-${Date.now()}-${Math.floor(Math.random()*1e3)}`,G=new WeakMap,de=new WeakMap,me={current:[]};let Fe=!1,te=0;const Y=new Set,ae=new Map;function Qe(i){const r=Array.from(i).sort((s,e)=>s instanceof B&&s.options.deps.includes(e)?1:e instanceof B&&e.options.deps.includes(s)?-1:0);for(const s of r){if(me.current.includes(s))continue;me.current.push(s),s.recompute();const e=de.get(s);if(e)for(const t of e){const a=G.get(t);a&&Qe(a)}}}function ct(i){const r={prevVal:i.prevState,currentVal:i.state};for(const s of i.listeners)s(r)}function dt(i){const r={prevVal:i.prevState,currentVal:i.state};for(const s of i.listeners)s(r)}function Ye(i){if(te>0&&!ae.has(i)&&ae.set(i,i.prevState),Y.add(i),!(te>0)&&!Fe)try{for(Fe=!0;Y.size>0;){const r=Array.from(Y);Y.clear();for(const s of r){const e=ae.get(s)??s.prevState;s.prevState=e,ct(s)}for(const s of r){const e=G.get(s);e&&(me.current.push(s),Qe(e))}for(const s of r){const e=G.get(s);if(e)for(const t of e)dt(t)}}}finally{Fe=!1,me.current=[],ae.clear()}}function $(i){te++;try{i()}finally{if(te--,te===0){const r=Y.values().next().value;r&&Ye(r)}}}function ht(i){return typeof i=="function"}class Le{constructor(r,s){this.listeners=new Set,this.subscribe=e=>{var t,a;this.listeners.add(e);const n=(a=(t=this.options)==null?void 0:t.onSubscribe)==null?void 0:a.call(t,e,this);return()=>{this.listeners.delete(e),n==null||n()}},this.prevState=r,this.state=r,this.options=s}setState(r){var s,e,t;this.prevState=this.state,(s=this.options)!=null&&s.updateFn?this.state=this.options.updateFn(this.prevState)(r):ht(r)?this.state=r(this.prevState):this.state=r,(t=(e=this.options)==null?void 0:e.onUpdate)==null||t.call(e),Ye(this)}}class B{constructor(r){this.listeners=new Set,this._subscriptions=[],this.lastSeenDepValues=[],this.getDepVals=()=>{const s=this.options.deps.length,e=new Array(s),t=new Array(s);for(let a=0;a<s;a++){const n=this.options.deps[a];e[a]=n.prevState,t[a]=n.state}return this.lastSeenDepValues=t,{prevDepVals:e,currDepVals:t,prevVal:this.prevState??void 0}},this.recompute=()=>{var s,e;this.prevState=this.state;const t=this.getDepVals();this.state=this.options.fn(t),(e=(s=this.options).onUpdate)==null||e.call(s)},this.checkIfRecalculationNeededDeeply=()=>{for(const a of this.options.deps)a instanceof B&&a.checkIfRecalculationNeededDeeply();let s=!1;const e=this.lastSeenDepValues,{currDepVals:t}=this.getDepVals();for(let a=0;a<t.length;a++)if(t[a]!==e[a]){s=!0;break}s&&this.recompute()},this.mount=()=>(this.registerOnGraph(),this.checkIfRecalculationNeededDeeply(),()=>{this.unregisterFromGraph();for(const s of this._subscriptions)s()}),this.subscribe=s=>{var e,t;this.listeners.add(s);const a=(t=(e=this.options).onSubscribe)==null?void 0:t.call(e,s,this);return()=>{this.listeners.delete(s),a==null||a()}},this.options=r,this.state=r.fn({prevDepVals:void 0,prevVal:void 0,currDepVals:this.getDepVals().currDepVals})}registerOnGraph(r=this.options.deps){for(const s of r)if(s instanceof B)s.registerOnGraph(),this.registerOnGraph(s.options.deps);else if(s instanceof Le){let e=G.get(s);e||(e=new Set,G.set(s,e)),e.add(this);let t=de.get(this);t||(t=new Set,de.set(this,t)),t.add(s)}}unregisterFromGraph(r=this.options.deps){for(const s of r)if(s instanceof B)this.unregisterFromGraph(s.options.deps);else if(s instanceof Le){const e=G.get(s);e&&e.delete(this);const t=de.get(this);t&&t.delete(s)}}}function Se(i,r){return typeof i=="function"?i(r):i}function ee(i,r){return Ce(r).reduce((e,t)=>{if(e===null)return null;if(typeof e<"u")return e[t]},i)}function ne(i,r,s){const e=Ce(r);function t(a){if(!e.length)return Se(s,a);const n=e.shift();if(typeof n=="string"||typeof n=="number"&&!Array.isArray(a))return typeof a=="object"?(a===null&&(a={}),{...a,[n]:t(a[n])}):{[n]:t()};if(Array.isArray(a)&&typeof n=="number"){const l=a.slice(0,n);return[...l.length?l:new Array(n),t(a[n]),...a.slice(n+1)]}return[...new Array(n),t()]}return t(i)}function ft(i,r){const s=Ce(r);function e(t){if(!t)return;if(s.length===1){const n=s[0];if(Array.isArray(t)&&typeof n=="number")return t.filter((u,h)=>h!==n);const{[n]:l,...c}=t;return c}const a=s.shift();if(typeof a=="string"&&typeof t=="object")return{...t,[a]:e(t[a])};if(typeof a=="number"&&Array.isArray(t)){if(a>=t.length)return t;const n=t.slice(0,a);return[...n.length?n:new Array(a),e(t[a]),...t.slice(a+1)]}throw new Error("It seems we have created an infinite loop in deleteBy. ")}return e(i)}const mt=/^(\d+)$/gm,vt=/\.(\d+)(?=\.)/gm,gt=/^(\d+)\./gm,Mt=/\.(\d+$)/gm,St=/\.{2,}/gm,Ie="__int__",oe=`${Ie}$1`;function Ce(i){if(Array.isArray(i))return[...i];if(typeof i!="string")throw new Error("Path must be a string.");return i.replace(/(^\[)|]/gm,"").replace(/\[/g,".").replace(mt,oe).replace(vt,`.${oe}.`).replace(gt,`${oe}.`).replace(Mt,`.${oe}`).replace(St,".").split(".").map(r=>{if(r.startsWith(Ie)){const s=r.substring(Ie.length),e=parseInt(s,10);return String(e)===s?e:s}return r})}function bt(i){return!(Array.isArray(i)&&i.length===0)}function _e(i,r){const s=e=>e.validators.filter(Boolean).map(t=>({cause:t.cause,validate:t.fn}));return r.validationLogic({form:r.form,validators:r.validators,event:{type:i,async:!1},runValidation:s})}function De(i,r){const{asyncDebounceMs:s}=r,{onBlurAsyncDebounceMs:e,onChangeAsyncDebounceMs:t,onDynamicAsyncDebounceMs:a}=r.validators||{},n=s??0,l=c=>c.validators.filter(Boolean).map(u=>{const h=(u==null?void 0:u.cause)||i;let d=n;switch(h){case"change":d=t??n;break;case"blur":d=e??n;break;case"dynamic":d=a??n;break;case"submit":d=0;break}return i==="submit"&&(d=0),{cause:h,validate:u.fn,debounceMs:d}});return r.validationLogic({form:r.form,validators:r.validators,event:{type:i,async:!0},runValidation:l})}const Te=i=>!!i&&typeof i=="object"&&"fields"in i;function W(i,r){if(Object.is(i,r))return!0;if(typeof i!="object"||i===null||typeof r!="object"||r===null)return!1;if(i instanceof Date&&r instanceof Date)return i.getTime()===r.getTime();if(i instanceof Map&&r instanceof Map){if(i.size!==r.size)return!1;for(const[t,a]of i)if(!r.has(t)||!Object.is(a,r.get(t)))return!1;return!0}if(i instanceof Set&&r instanceof Set){if(i.size!==r.size)return!1;for(const t of i)if(!r.has(t))return!1;return!0}const s=Object.keys(i),e=Object.keys(r);if(s.length!==e.length)return!1;for(const t of s)if(!e.includes(t)||!W(i[t],r[t]))return!1;return!0}const je=({newFormValidatorError:i,isPreviousErrorFromFormValidator:r,previousErrorValue:s})=>i?{newErrorValue:i,newSource:"form"}:r?{newErrorValue:void 0,newSource:void 0}:s?{newErrorValue:s,newSource:"field"}:{newErrorValue:void 0,newSource:void 0},We=({formLevelError:i,fieldLevelError:r})=>r?{newErrorValue:r,newSource:"field"}:i?{newErrorValue:i,newSource:"form"}:{newErrorValue:void 0,newSource:void 0};function C(i,r){return i==null?r:{...i,...r}}let N=256;const he=[];let le;for(;N--;)he[N]=(N+256).toString(16).substring(1);function yt(){let i=0,r,s="";if(!le||N+16>256){for(le=new Array(256),i=256;i--;)le[i]=256*Math.random()|0;i=0,N=0}for(;i<16;i++)r=le[N+i],i===6?s+=he[r&15|64]:i===8?s+=he[r&63|128]:s+=he[r],i&1&&i>1&&i<11&&(s+="-");return N++,s}const q=i=>{if(!i.validators)return i.runValidation({validators:[],form:i.form});const r=i.event.async,s=r?void 0:{fn:i.validators.onMount,cause:"mount"},e={fn:r?i.validators.onChangeAsync:i.validators.onChange,cause:"change"},t={fn:r?i.validators.onBlurAsync:i.validators.onBlur,cause:"blur"},a={fn:r?i.validators.onSubmitAsync:i.validators.onSubmit,cause:"submit"},n=r?void 0:{fn:()=>{},cause:"server"};switch(i.event.type){case"mount":return i.runValidation({validators:[s],form:i.form});case"submit":return i.runValidation({validators:[e,t,a,n],form:i.form});case"server":return i.runValidation({validators:[],form:i.form});case"blur":return i.runValidation({validators:[t,n],form:i.form});case"change":return i.runValidation({validators:[e,n],form:i.form});default:throw new Error(`Unknown validation event type: ${i.event.type}`)}};function pt(i,r){const s=new Map;for(const e of i){const t=e.path??[];let a=r,n="";for(let l=0;l<t.length;l++){const c=t[l];if(c===void 0)continue;const u=typeof c=="object"?c.key:c,h=Number(u);Array.isArray(a)&&!Number.isNaN(h)?n+=`[${h}]`:n+=(l>0?".":"")+String(u),typeof a=="object"&&a!==null?a=a[u]:a=void 0}s.set(n,(s.get(n)??[]).concat(e))}return Object.fromEntries(s)}const qe=(i,r)=>{const s=pt(i,r);return{form:s,fields:s}},K={validate({value:i,validationSource:r},s){const e=s["~standard"].validate(i);if(e instanceof Promise)throw new Error("async function passed to sync validator");if(e.issues)return r==="field"?e.issues:qe(e.issues,i)},async validateAsync({value:i,validationSource:r},s){const e=await s["~standard"].validate(i);if(e.issues)return r==="field"?e.issues:qe(e.issues,i)}},et=i=>!!i&&"~standard"in i,ve={isValidating:!1,isTouched:!1,isBlurred:!1,isDirty:!1,isPristine:!0,isValid:!0,isDefaultValue:!0,errors:[],errorMap:{},errorSourceMap:{}};function ue(i){function r(d,o,m,f){const v=e(d,o,m,f);({insert:()=>l(v,d,o),remove:()=>c(v),swap:()=>f!==void 0&&h(v,d,o,f),move:()=>f!==void 0&&u(v,d,o,f)})[m]()}function s(d,o){return`${d}[${o}]`}function e(d,o,m,f){const v=[s(d,o)];if(m==="swap")v.push(s(d,f));else if(m==="move"){const[g,M]=[Math.min(o,f),Math.max(o,f)];for(let b=g;b<=M;b++)v.push(s(d,b))}else{const g=i.getFieldValue(d),M=Array.isArray(g)?g.length:0;for(let b=o+1;b<M;b++)v.push(s(d,b))}return Object.keys(i.fieldInfo).filter(g=>v.some(M=>g.startsWith(M)))}function t(d,o){return d.replace(/\[(\d+)\]/,(m,f)=>{const v=parseInt(f,10);return`[${o==="up"?v+1:Math.max(0,v-1)}]`})}function a(d,o){(o==="up"?d:[...d].reverse()).forEach(f=>{const v=t(f.toString(),o),g=i.getFieldMeta(v);g?i.setFieldMeta(f,g):i.setFieldMeta(f,n())})}const n=()=>ve,l=(d,o,m)=>{a(d,"down"),d.forEach(f=>{f.toString().startsWith(s(o,m))&&i.setFieldMeta(f,n())})},c=d=>{a(d,"up")},u=(d,o,m,f)=>{const v=new Map(Object.keys(i.fieldInfo).filter(g=>g.startsWith(s(o,m))).map(g=>[g,i.getFieldMeta(g)]));a(d,m<f?"up":"down"),Object.keys(i.fieldInfo).filter(g=>g.startsWith(s(o,f))).forEach(g=>{const M=g.replace(s(o,f),s(o,m)),b=v.get(M);b&&i.setFieldMeta(g,b)})},h=(d,o,m,f)=>{d.forEach(v=>{if(!v.toString().startsWith(s(o,m)))return;const g=v.toString().replace(s(o,m),s(o,f)),[M,b]=[i.getFieldMeta(v),i.getFieldMeta(g)];M&&i.setFieldMeta(g,M),b&&i.setFieldMeta(v,b)})};return{handleArrayFieldMetaShift:r}}var z,T,_,se,x,U,P,H,ie,Me,re,Z;class Vt{constructor({pluginId:r,debug:s=!1,enabled:e=!0}){k(this,z,!0);k(this,T);k(this,_);k(this,se);k(this,x);k(this,U);k(this,P);k(this,H);k(this,ie,0);k(this,Me,5);k(this,re,()=>{this.debugLog("Connected to event bus"),D(this,U,!0),this.debugLog("Emitting queued events",S(this,x)),S(this,x).forEach(r=>this.emitEventToBus(r)),D(this,x,[]),this.stopConnectLoop(),S(this,_).call(this).removeEventListener("tanstack-connect-success",S(this,re))});k(this,Z,()=>{if(S(this,_).call(this).addEventListener("tanstack-connect-success",S(this,re)),S(this,ie)<S(this,Me)){ze(this,ie)._++,this.dispatchCustomEvent("tanstack-connect",{});return}S(this,_).call(this).removeEventListener("tanstack-connect",S(this,Z)),this.debugLog("Max retries reached, giving up on connection"),this.stopConnectLoop()});D(this,T,r),D(this,z,e),D(this,_,this.getGlobalTarget),D(this,se,s),this.debugLog(" Initializing event subscription for plugin",S(this,T)),D(this,x,[]),D(this,U,!1),D(this,P,null),D(this,H,500)}startConnectLoop(){S(this,P)!==null||S(this,U)||(this.debugLog(`Starting connect loop (every ${S(this,H)}ms)`),D(this,P,setInterval(S(this,Z),S(this,H))))}stopConnectLoop(){S(this,P)!==null&&(clearInterval(S(this,P)),D(this,P,null),this.debugLog("Stopped connect loop"))}debugLog(...r){S(this,se)&&console.log(`ðŸŒ´ [tanstack-devtools:${S(this,T)}-plugin]`,...r)}getGlobalTarget(){if(typeof globalThis<"u"&&globalThis.__TANSTACK_EVENT_TARGET__)return this.debugLog("Using global event target"),globalThis.__TANSTACK_EVENT_TARGET__;if(typeof window<"u"&&typeof window.addEventListener<"u")return this.debugLog("Using window as event target"),window;const r=typeof EventTarget<"u"?new EventTarget:void 0;return typeof r>"u"||typeof r.addEventListener>"u"?(this.debugLog("No event mechanism available, running in non-web environment"),{addEventListener:()=>{},removeEventListener:()=>{},dispatchEvent:()=>!1}):(this.debugLog("Using new EventTarget as fallback"),r)}getPluginId(){return S(this,T)}dispatchCustomEventShim(r,s){try{const e=new Event(r,{detail:s});S(this,_).call(this).dispatchEvent(e)}catch{this.debugLog("Failed to dispatch shim event")}}dispatchCustomEvent(r,s){try{S(this,_).call(this).dispatchEvent(new CustomEvent(r,{detail:s}))}catch{this.dispatchCustomEventShim(r,s)}}emitEventToBus(r){this.debugLog("Emitting event to client bus",r),this.dispatchCustomEvent("tanstack-dispatch-event",r)}emit(r,s){if(!S(this,z)){this.debugLog("Event bus client is disabled, not emitting event",r,s);return}if(!S(this,U)){this.debugLog("Bus not available, will be pushed as soon as connected"),S(this,x).push({type:`${S(this,T)}:${r}`,payload:s,pluginId:S(this,T)}),typeof CustomEvent<"u"&&(S(this,Z).call(this),this.startConnectLoop());return}return this.emitEventToBus({type:`${S(this,T)}:${r}`,payload:s,pluginId:S(this,T)})}on(r,s){const e=`${S(this,T)}:${r}`;if(!S(this,z))return this.debugLog("Event bus client is disabled, not registering event",e),()=>{};const t=a=>{this.debugLog("Received event from bus",a.detail),s(a.detail)};return S(this,_).call(this).addEventListener(e,t),this.debugLog("Registered event to bus",e),()=>{S(this,_).call(this).removeEventListener(e,t)}}onAll(r){if(!S(this,z))return this.debugLog("Event bus client is disabled, not registering event"),()=>{};const s=e=>{const t=e.detail;r(t)};return S(this,_).call(this).addEventListener("tanstack-devtools-global",s),()=>S(this,_).call(this).removeEventListener("tanstack-devtools-global",s)}onAllPluginEvents(r){if(!S(this,z))return this.debugLog("Event bus client is disabled, not registering event"),()=>{};const s=e=>{const t=e.detail;S(this,T)&&t.pluginId!==S(this,T)||r(t)};return S(this,_).call(this).addEventListener("tanstack-devtools-global",s),()=>S(this,_).call(this).removeEventListener("tanstack-devtools-global",s)}}z=new WeakMap,T=new WeakMap,_=new WeakMap,se=new WeakMap,x=new WeakMap,U=new WeakMap,P=new WeakMap,H=new WeakMap,ie=new WeakMap,Me=new WeakMap,re=new WeakMap,Z=new WeakMap;class Ft extends Vt{constructor(){super({pluginId:"form-devtools"})}}const O=new Ft;function Ee(i){return{values:i.values??{},errorMap:i.errorMap??{},fieldMetaBase:i.fieldMetaBase??{},isSubmitted:i.isSubmitted??!1,isSubmitting:i.isSubmitting??!1,isValidating:i.isValidating??!1,submissionAttempts:i.submissionAttempts??0,isSubmitSuccessful:i.isSubmitSuccessful??!1,validationMetaMap:i.validationMetaMap??{onChange:void 0,onBlur:void 0,onSubmit:void 0,onMount:void 0,onServer:void 0,onDynamic:void 0}}}class Et{constructor(r){var s;this.options={},this.fieldInfo={},this.prevTransformArray=[],this.mount=()=>{var l,c;const e=this.fieldMetaDerived.mount(),t=this.store.mount(),a=()=>{e(),t(),O.emit("form-unmounted",{id:this._formId})};(c=(l=this.options.listeners)==null?void 0:l.onMount)==null||c.call(l,{formApi:this});const{onMount:n}=this.options.validators||{};return O.emit("form-state-change",{id:this._formId,state:this.store.state,options:this.options}),n&&this.validateSync("mount"),a},this.update=e=>{var c,u;if(!e)return;const t=this.options;this.options=e;const a=!!((u=(c=e.transform)==null?void 0:c.deps)!=null&&u.some((h,d)=>h!==this.prevTransformArray[d])),n=e.defaultValues&&!W(e.defaultValues,t.defaultValues)&&!this.state.isTouched,l=!W(e.defaultState,t.defaultState)&&!this.state.isTouched;!n&&!l&&!a||$(()=>{this.baseStore.setState(()=>Ee(Object.assign({},this.state,l?e.defaultState:{},n?{values:e.defaultValues}:{},a?{_force_re_eval:!this.state._force_re_eval}:{})))})},this.reset=(e,t)=>{const{fieldMeta:a}=this.state,n=this.resetFieldMeta(a);e&&!(t!=null&&t.keepDefaultValues)&&(this.options={...this.options,defaultValues:e}),this.baseStore.setState(()=>{var l;return Ee({...this.options.defaultState,values:e??this.options.defaultValues??((l=this.options.defaultState)==null?void 0:l.values),fieldMetaBase:n})})},this.validateAllFields=async e=>{const t=[];return $(()=>{Object.values(this.fieldInfo).forEach(n=>{if(!n.instance)return;const l=n.instance;t.push(Promise.resolve().then(()=>l.validate(e,{skipFormValidation:!0}))),n.instance.state.meta.isTouched||n.instance.setMeta(c=>({...c,isTouched:!0}))})}),(await Promise.all(t)).flat()},this.validateArrayFieldsStartingFrom=async(e,t,a)=>{const n=this.getFieldValue(e),l=Array.isArray(n)?Math.max(n.length-1,0):null,c=[`${e}[${t}]`];for(let o=t+1;o<=(l??0);o++)c.push(`${e}[${o}]`);const u=Object.keys(this.fieldInfo).filter(o=>c.some(m=>o.startsWith(m))),h=[];return $(()=>{u.forEach(o=>{h.push(Promise.resolve().then(()=>this.validateField(o,a)))})}),(await Promise.all(h)).flat()},this.validateField=(e,t)=>{var n;const a=(n=this.fieldInfo[e])==null?void 0:n.instance;return a?(a.state.meta.isTouched||a.setMeta(l=>({...l,isTouched:!0})),a.validate(t)):[]},this.validateSync=e=>{const t=_e(e,{...this.options,form:this,validationLogic:this.options.validationLogic||q});let a=!1;const n={};return $(()=>{var u,h,d;for(const o of t){if(!o.validate)continue;const m=this.runValidator({validate:o.validate,value:{value:this.state.values,formApi:this,validationSource:"form"},type:"validate"}),{formError:f,fieldErrors:v}=fe(m),g=Q(o.cause);for(const M of Object.keys(this.state.fieldMeta)){if(this.baseStore.state.fieldMetaBase[M]===void 0)continue;const b=this.getFieldMeta(M);if(!b)continue;const{errorMap:y,errorSourceMap:V}=b,E=v==null?void 0:v[M],{newErrorValue:F,newSource:w}=je({newFormValidatorError:E,isPreviousErrorFromFormValidator:(V==null?void 0:V[g])==="form",previousErrorValue:y==null?void 0:y[g]});w==="form"&&(n[M]={...n[M],[g]:E}),(y==null?void 0:y[g])!==F&&this.setFieldMeta(M,I=>({...I,errorMap:{...I.errorMap,[g]:F},errorSourceMap:{...I.errorSourceMap,[g]:w}}))}((u=this.state.errorMap)==null?void 0:u[g])!==f&&this.baseStore.setState(M=>({...M,errorMap:{...M.errorMap,[g]:f}})),(f||v)&&(a=!0)}const l=Q("submit");(h=this.state.errorMap)!=null&&h[l]&&e!=="submit"&&!a&&this.baseStore.setState(o=>({...o,errorMap:{...o.errorMap,[l]:void 0}}));const c=Q("server");(d=this.state.errorMap)!=null&&d[c]&&e!=="server"&&!a&&this.baseStore.setState(o=>({...o,errorMap:{...o.errorMap,[c]:void 0}}))}),{hasErrored:a,fieldsErrorMap:n}},this.validateAsync=async e=>{const t=De(e,{...this.options,form:this,validationLogic:this.options.validationLogic||q});this.state.isFormValidating||this.baseStore.setState(u=>({...u,isFormValidating:!0}));const a=[];let n;for(const u of t){if(!u.validate)continue;const h=Q(u.cause),d=this.state.validationMetaMap[h];d==null||d.lastAbortController.abort();const o=new AbortController;this.state.validationMetaMap[h]={lastAbortController:o},a.push(new Promise(async m=>{let f;try{f=await new Promise((b,y)=>{setTimeout(async()=>{if(o.signal.aborted)return b(void 0);try{b(await this.runValidator({validate:u.validate,value:{value:this.state.values,formApi:this,validationSource:"form",signal:o.signal},type:"validateAsync"}))}catch(V){y(V)}},u.debounceMs)})}catch(b){f=b}const{formError:v,fieldErrors:g}=fe(f);g&&(n=n?{...n,...g}:g);const M=Q(u.cause);for(const b of Object.keys(this.state.fieldMeta)){if(this.baseStore.state.fieldMetaBase[b]===void 0)continue;const y=this.getFieldMeta(b);if(!y)continue;const{errorMap:V,errorSourceMap:E}=y,F=n==null?void 0:n[b],{newErrorValue:w,newSource:I}=je({newFormValidatorError:F,isPreviousErrorFromFormValidator:(E==null?void 0:E[M])==="form",previousErrorValue:V==null?void 0:V[M]});(V==null?void 0:V[M])!==w&&this.setFieldMeta(b,L=>({...L,errorMap:{...L.errorMap,[M]:w},errorSourceMap:{...L.errorSourceMap,[M]:I}}))}this.baseStore.setState(b=>({...b,errorMap:{...b.errorMap,[M]:v}})),m(n?{fieldErrors:n,errorMapKey:M}:void 0)}))}let l=[];const c={};if(a.length){l=await Promise.all(a);for(const u of l)if(u!=null&&u.fieldErrors){const{errorMapKey:h}=u;for(const[d,o]of Object.entries(u.fieldErrors)){const f={...c[d]||{},[h]:o};c[d]=f}}}return this.baseStore.setState(u=>({...u,isFormValidating:!1})),c},this.validate=e=>{const{hasErrored:t,fieldsErrorMap:a}=this.validateSync(e);return t&&!this.options.asyncAlways?a:this.validateAsync(e)},this.getFieldValue=e=>ee(this.state.values,e),this.getFieldMeta=e=>this.state.fieldMeta[e],this.getFieldInfo=e=>{var t;return(t=this.fieldInfo)[e]||(t[e]={instance:null,validationMetaMap:{onChange:void 0,onBlur:void 0,onSubmit:void 0,onMount:void 0,onServer:void 0,onDynamic:void 0}})},this.setFieldMeta=(e,t)=>{this.baseStore.setState(a=>({...a,fieldMetaBase:{...a.fieldMetaBase,[e]:Se(t,a.fieldMetaBase[e])}}))},this.resetFieldMeta=e=>Object.keys(e).reduce((t,a)=>{const n=a;return t[n]=ve,t},{}),this.setFieldValue=(e,t,a)=>{var u;const n=(a==null?void 0:a.dontUpdateMeta)??!1,l=(a==null?void 0:a.dontRunListeners)??!1,c=(a==null?void 0:a.dontValidate)??!1;$(()=>{n||this.setFieldMeta(e,h=>({...h,isTouched:!0,isDirty:!0,errorMap:{...h==null?void 0:h.errorMap,onMount:void 0}})),this.baseStore.setState(h=>({...h,values:ne(h.values,e,t)}))}),l||(u=this.getFieldInfo(e).instance)==null||u.triggerOnChangeListener(),c||this.validateField(e,"change")},this.deleteField=e=>{const a=[...Object.keys(this.fieldInfo).filter(n=>{const l=e.toString();return n!==l&&n.startsWith(l)}),e];this.baseStore.setState(n=>{const l={...n};return a.forEach(c=>{l.values=ft(l.values,c),delete this.fieldInfo[c],delete l.fieldMetaBase[c]}),l})},this.pushFieldValue=(e,t,a)=>{this.setFieldValue(e,n=>[...Array.isArray(n)?n:[],t],a)},this.insertFieldValue=async(e,t,a,n)=>{this.setFieldValue(e,c=>[...c.slice(0,t),a,...c.slice(t)],C(n,{dontValidate:!0}));const l=(n==null?void 0:n.dontValidate)??!1;l||await this.validateField(e,"change"),ue(this).handleArrayFieldMetaShift(e,t,"insert"),l||await this.validateArrayFieldsStartingFrom(e,t,"change")},this.replaceFieldValue=async(e,t,a,n)=>{this.setFieldValue(e,c=>c.map((u,h)=>h===t?a:u),C(n,{dontValidate:!0})),((n==null?void 0:n.dontValidate)??!1)||(await this.validateField(e,"change"),await this.validateArrayFieldsStartingFrom(e,t,"change"))},this.removeFieldValue=async(e,t,a)=>{const n=this.getFieldValue(e),l=Array.isArray(n)?Math.max(n.length-1,0):null;if(this.setFieldValue(e,u=>u.filter((h,d)=>d!==t),C(a,{dontValidate:!0})),ue(this).handleArrayFieldMetaShift(e,t,"remove"),l!==null){const u=`${e}[${l}]`;this.deleteField(u)}((a==null?void 0:a.dontValidate)??!1)||(await this.validateField(e,"change"),await this.validateArrayFieldsStartingFrom(e,t,"change"))},this.swapFieldValues=(e,t,a,n)=>{this.setFieldValue(e,c=>{const u=c[t],h=c[a];return ne(ne(c,`${t}`,h),`${a}`,u)},C(n,{dontValidate:!0})),ue(this).handleArrayFieldMetaShift(e,t,"swap",a),((n==null?void 0:n.dontValidate)??!1)||(this.validateField(e,"change"),this.validateField(`${e}[${t}]`,"change"),this.validateField(`${e}[${a}]`,"change"))},this.moveFieldValues=(e,t,a,n)=>{this.setFieldValue(e,c=>{const u=[...c];return u.splice(a,0,u.splice(t,1)[0]),u},C(n,{dontValidate:!0})),ue(this).handleArrayFieldMetaShift(e,t,"move",a),((n==null?void 0:n.dontValidate)??!1)||(this.validateField(e,"change"),this.validateField(`${e}[${t}]`,"change"),this.validateField(`${e}[${a}]`,"change"))},this.clearFieldValues=(e,t)=>{const a=this.getFieldValue(e),n=Array.isArray(a)?Math.max(a.length-1,0):null;if(this.setFieldValue(e,[],C(t,{dontValidate:!0})),n!==null)for(let c=0;c<=n;c++){const u=`${e}[${c}]`;this.deleteField(u)}((t==null?void 0:t.dontValidate)??!1)||this.validateField(e,"change")},this.resetField=e=>{this.baseStore.setState(t=>({...t,fieldMetaBase:{...t.fieldMetaBase,[e]:ve},values:this.options.defaultValues?ne(t.values,e,ee(this.options.defaultValues,e)):t.values}))},this.getAllErrors=()=>({form:{errors:this.state.errors,errorMap:this.state.errorMap},fields:Object.entries(this.state.fieldMeta).reduce((e,[t,a])=>(Object.keys(a).length&&a.errors.length&&(e[t]={errors:a.errors,errorMap:a.errorMap}),e),{})}),this.parseValuesWithSchema=e=>K.validate({value:this.state.values,validationSource:"form"},e),this.parseValuesWithSchemaAsync=e=>K.validateAsync({value:this.state.values,validationSource:"form"},e),this.timeoutIds={validations:{},listeners:{},formListeners:{}},this._formId=(r==null?void 0:r.formId)??yt(),this._devtoolsSubmissionOverride=!1,this.baseStore=new Le(Ee({...r==null?void 0:r.defaultState,values:(r==null?void 0:r.defaultValues)??((s=r==null?void 0:r.defaultState)==null?void 0:s.values)})),this.fieldMetaDerived=new B({deps:[this.baseStore],fn:({prevDepVals:e,currDepVals:t,prevVal:a})=>{var d,o,m;const n=a,l=e==null?void 0:e[0],c=t[0];let u=0;const h={};for(const f of Object.keys(c.fieldMetaBase)){const v=c.fieldMetaBase[f],g=l==null?void 0:l.fieldMetaBase[f],M=n==null?void 0:n[f],b=ee(c.values,f);let y=M==null?void 0:M.errors;if(!g||v.errorMap!==g.errorMap){y=Object.values(v.errorMap??{}).filter(I=>I!==void 0);const w=(d=this.getFieldInfo(f))==null?void 0:d.instance;w&&!w.options.disableErrorFlat&&(y=y==null?void 0:y.flat(1))}const V=!bt(y??[]),E=!v.isDirty,F=W(b,ee(this.options.defaultValues,f))||W(b,(m=(o=this.getFieldInfo(f))==null?void 0:o.instance)==null?void 0:m.options.defaultValue);if(M&&M.isPristine===E&&M.isValid===V&&M.isDefaultValue===F&&M.errors===y&&v===g){h[f]=M,u++;continue}h[f]={...v,errors:y,isPristine:E,isValid:V,isDefaultValue:F}}return Object.keys(c.fieldMetaBase).length&&n&&u===Object.keys(c.fieldMetaBase).length?n:h}}),this.store=new B({deps:[this.baseStore,this.fieldMetaDerived],fn:({prevDepVals:e,currDepVals:t,prevVal:a})=>{var ke,Oe,Re,$e;const n=a,l=e==null?void 0:e[0],c=t[0],u=t[1],h=Object.values(u).filter(Boolean),d=h.some(p=>p.isValidating),o=h.every(p=>p.isValid),m=h.some(p=>p.isTouched),f=h.some(p=>p.isBlurred),v=h.every(p=>p.isDefaultValue),g=m&&((ke=c.errorMap)==null?void 0:ke.onMount),M=h.some(p=>p.isDirty),b=!M,y=!!((Oe=c.errorMap)!=null&&Oe.onMount||h.some(p=>{var R;return(R=p==null?void 0:p.errorMap)==null?void 0:R.onMount})),V=!!d;let E=(n==null?void 0:n.errors)??[];(!l||c.errorMap!==l.errorMap)&&(E=Object.values(c.errorMap).reduce((p,R)=>R===void 0?p:R&&Te(R)?(p.push(R.form),p):(p.push(R),p),[]));const F=E.length===0,w=o&&F,I=this.options.canSubmitWhenInvalid??!1,L=c.submissionAttempts===0&&!m&&!y||!V&&!c.isSubmitting&&w||I;let j=c.errorMap;if(g&&(E=E.filter(p=>p!==c.errorMap.onMount),j=Object.assign(j,{onMount:void 0})),n&&l&&n.errorMap===j&&n.fieldMeta===this.fieldMetaDerived.state&&n.errors===E&&n.isFieldsValidating===d&&n.isFieldsValid===o&&n.isFormValid===F&&n.isValid===w&&n.canSubmit===L&&n.isTouched===m&&n.isBlurred===f&&n.isPristine===b&&n.isDefaultValue===v&&n.isDirty===M&&W(l,c))return n;let X={...c,errorMap:j,fieldMeta:this.fieldMetaDerived.state,errors:E,isFieldsValidating:d,isFieldsValid:o,isFormValid:F,isValid:w,canSubmit:L,isTouched:m,isBlurred:f,isPristine:b,isDefaultValue:v,isDirty:M};const be=((Re=this.options.transform)==null?void 0:Re.deps)??[];if(be.length!==this.prevTransformArray.length||be.some((p,R)=>p!==this.prevTransformArray[R])){const p=Object.assign({},this,{state:X});($e=this.options.transform)==null||$e.fn(p),X=p.state,this.prevTransformArray=be}return X}}),this.handleSubmit=this.handleSubmit.bind(this),this.update(r||{}),this.store.subscribe(()=>{O.emit("form-state-change",{id:this._formId,state:this.store.state,options:this.options})}),O.on("request-form-state",e=>{e.payload.id===this._formId&&O.emit("form-state-change",{id:this._formId,state:this.store.state,options:this.options})}),O.on("request-form-reset",e=>{e.payload.id===this._formId&&this.reset()}),O.on("request-form-force-submit",e=>{e.payload.id===this._formId&&(this._devtoolsSubmissionOverride=!0,this.handleSubmit(),this._devtoolsSubmissionOverride=!1)})}get state(){return this.store.state}get formId(){return this._formId}runValidator(r){return et(r.validate)?K[r.type](r.value,r.validate):r.validate(r.value)}async handleSubmit(r){var t,a,n,l,c,u,h,d,o,m;this.baseStore.setState(f=>({...f,isSubmitted:!1,submissionAttempts:f.submissionAttempts+1,isSubmitSuccessful:!1})),$(()=>{Object.values(this.fieldInfo).forEach(f=>{f.instance&&(f.instance.state.meta.isTouched||f.instance.setMeta(v=>({...v,isTouched:!0})))})});const s=r??this.options.onSubmitMeta;if(!this.state.canSubmit&&!this._devtoolsSubmissionOverride){(a=(t=this.options).onSubmitInvalid)==null||a.call(t,{value:this.state.values,formApi:this,meta:s});return}this.baseStore.setState(f=>({...f,isSubmitting:!0}));const e=()=>{this.baseStore.setState(f=>({...f,isSubmitting:!1}))};if(await this.validateAllFields("submit"),!this.state.isFieldsValid){e(),(l=(n=this.options).onSubmitInvalid)==null||l.call(n,{value:this.state.values,formApi:this,meta:s}),O.emit("form-submission-state-change",{id:this._formId,submissionAttempt:this.state.submissionAttempts,successful:!1,stage:"validateAllFields",errors:Object.values(this.state.fieldMeta).map(f=>f.errors).flat()});return}if(await this.validate("submit"),!this.state.isValid){e(),(u=(c=this.options).onSubmitInvalid)==null||u.call(c,{value:this.state.values,formApi:this,meta:s}),O.emit("form-submission-state-change",{id:this._formId,submissionAttempt:this.state.submissionAttempts,successful:!1,stage:"validate",errors:this.state.errors});return}$(()=>{Object.values(this.fieldInfo).forEach(f=>{var v,g,M;(M=(g=(v=f.instance)==null?void 0:v.options.listeners)==null?void 0:g.onSubmit)==null||M.call(g,{value:f.instance.state.value,fieldApi:f.instance})})}),(d=(h=this.options.listeners)==null?void 0:h.onSubmit)==null||d.call(h,{formApi:this,meta:s});try{await((m=(o=this.options).onSubmit)==null?void 0:m.call(o,{value:this.state.values,formApi:this,meta:s})),$(()=>{this.baseStore.setState(f=>({...f,isSubmitted:!0,isSubmitSuccessful:!0})),O.emit("form-submission-state-change",{id:this._formId,submissionAttempt:this.state.submissionAttempts,successful:!0}),e()})}catch(f){throw this.baseStore.setState(v=>({...v,isSubmitSuccessful:!1})),O.emit("form-submission-state-change",{id:this._formId,submissionAttempt:this.state.submissionAttempts,successful:!1,stage:"inflight",onError:f}),e(),f}}setErrorMap(r){$(()=>{Object.entries(r).forEach(([s,e])=>{const t=s;if(Te(e)){const{formError:a,fieldErrors:n}=fe(e);for(const l of Object.keys(this.fieldInfo))this.getFieldMeta(l)&&this.setFieldMeta(l,u=>({...u,errorMap:{...u.errorMap,[t]:n==null?void 0:n[l]},errorSourceMap:{...u.errorSourceMap,[t]:"form"}}));this.baseStore.setState(l=>({...l,errorMap:{...l.errorMap,[t]:a}}))}else this.baseStore.setState(a=>({...a,errorMap:{...a.errorMap,[t]:e}}))})})}}function fe(i){if(i){if(Te(i)){const r=fe(i.form).formError,s=i.fields;return{formError:r,fieldErrors:s}}return{formError:i}}return{formError:void 0}}function Q(i){switch(i){case"submit":return"onSubmit";case"blur":return"onBlur";case"mount":return"onMount";case"server":return"onServer";case"dynamic":return"onDynamic";case"change":default:return"onChange"}}class wt{constructor(r){this.options={},this.mount=()=>{var a,n;const s=this.store.mount();this.options.defaultValue!==void 0&&this.form.setFieldValue(this.name,this.options.defaultValue,{dontUpdateMeta:!0});const e=this.getInfo();e.instance=this,this.update(this.options);const{onMount:t}=this.options.validators||{};if(t){const l=this.runValidator({validate:t,value:{value:this.state.value,fieldApi:this,validationSource:"field"},type:"validate"});l&&this.setMeta(c=>({...c,errorMap:{...c==null?void 0:c.errorMap,onMount:l},errorSourceMap:{...c==null?void 0:c.errorSourceMap,onMount:"field"}}))}return(n=(a=this.options.listeners)==null?void 0:a.onMount)==null||n.call(a,{value:this.state.value,fieldApi:this}),s},this.update=s=>{this.options=s;const e=this.name!==s.name;if(this.name=s.name,this.state.value===void 0){const t=ee(s.form.options.defaultValues,s.name),a=s.defaultValue??t;e?this.setValue(n=>n||a,{dontUpdateMeta:!0}):a!==void 0&&this.setValue(a,{dontUpdateMeta:!0})}this.form.getFieldMeta(this.name)===void 0&&this.setMeta(this.state.meta)},this.getValue=()=>this.form.getFieldValue(this.name),this.setValue=(s,e)=>{this.form.setFieldValue(this.name,s,C(e,{dontRunListeners:!0,dontValidate:!0})),e!=null&&e.dontRunListeners||this.triggerOnChangeListener(),e!=null&&e.dontValidate||this.validate("change")},this.getMeta=()=>this.store.state.meta,this.setMeta=s=>this.form.setFieldMeta(this.name,s),this.getInfo=()=>this.form.getFieldInfo(this.name),this.pushValue=(s,e)=>{this.form.pushFieldValue(this.name,s,C(e,{dontRunListeners:!0})),e!=null&&e.dontRunListeners||this.triggerOnChangeListener()},this.insertValue=(s,e,t)=>{this.form.insertFieldValue(this.name,s,e,C(t,{dontRunListeners:!0})),t!=null&&t.dontRunListeners||this.triggerOnChangeListener()},this.replaceValue=(s,e,t)=>{this.form.replaceFieldValue(this.name,s,e,C(t,{dontRunListeners:!0})),t!=null&&t.dontRunListeners||this.triggerOnChangeListener()},this.removeValue=(s,e)=>{this.form.removeFieldValue(this.name,s,C(e,{dontRunListeners:!0})),e!=null&&e.dontRunListeners||this.triggerOnChangeListener()},this.swapValues=(s,e,t)=>{this.form.swapFieldValues(this.name,s,e,C(t,{dontRunListeners:!0})),t!=null&&t.dontRunListeners||this.triggerOnChangeListener()},this.moveValue=(s,e,t)=>{this.form.moveFieldValues(this.name,s,e,C(t,{dontRunListeners:!0})),t!=null&&t.dontRunListeners||this.triggerOnChangeListener()},this.clearValues=s=>{this.form.clearFieldValues(this.name,C(s,{dontRunListeners:!0})),s!=null&&s.dontRunListeners||this.triggerOnChangeListener()},this.getLinkedFields=s=>{const e=Object.values(this.form.fieldInfo),t=[];for(const a of e){if(!a.instance)continue;const{onChangeListenTo:n,onBlurListenTo:l}=a.instance.options.validators||{};s==="change"&&(n!=null&&n.includes(this.name))&&t.push(a.instance),s==="blur"&&(l!=null&&l.includes(this.name))&&t.push(a.instance)}return t},this.validateSync=(s,e)=>{var u;const t=_e(s,{...this.options,form:this.form,validationLogic:this.form.options.validationLogic||q}),n=this.getLinkedFields(s).reduce((h,d)=>{const o=_e(s,{...d.options,form:d.form,validationLogic:d.form.options.validationLogic||q});return o.forEach(m=>{m.field=d}),h.concat(o)},[]);let l=!1;$(()=>{const h=(d,o)=>{var b;const m=ce(o.cause),f=o.validate?Ge(d.runValidator({validate:o.validate,value:{value:d.store.state.value,validationSource:"field",fieldApi:d},type:"validate"})):void 0,v=e[m],{newErrorValue:g,newSource:M}=We({formLevelError:v,fieldLevelError:f});((b=d.state.meta.errorMap)==null?void 0:b[m])!==g&&d.setMeta(y=>({...y,errorMap:{...y.errorMap,[m]:g},errorSourceMap:{...y.errorSourceMap,[m]:M}})),g&&(l=!0)};for(const d of t)h(this,d);for(const d of n)d.validate&&h(d.field,d)});const c=ce("submit");return(u=this.state.meta.errorMap)!=null&&u[c]&&s!=="submit"&&!l&&this.setMeta(h=>({...h,errorMap:{...h.errorMap,[c]:void 0},errorSourceMap:{...h.errorSourceMap,[c]:void 0}})),{hasErrored:l}},this.validateAsync=async(s,e)=>{const t=De(s,{...this.options,form:this.form,validationLogic:this.form.options.validationLogic||q}),a=await e,n=this.getLinkedFields(s),l=n.reduce((o,m)=>{const f=De(s,{...m.options,form:m.form,validationLogic:m.form.options.validationLogic||q});return f.forEach(v=>{v.field=m}),o.concat(f)},[]);this.state.meta.isValidating||this.setMeta(o=>({...o,isValidating:!0}));for(const o of n)o.setMeta(m=>({...m,isValidating:!0}));const c=[],u=[],h=(o,m,f)=>{const v=ce(m.cause),g=o.getInfo().validationMetaMap[v];g==null||g.lastAbortController.abort();const M=new AbortController;this.getInfo().validationMetaMap[v]={lastAbortController:M},f.push(new Promise(async b=>{var I;let y;try{y=await new Promise((L,j)=>{this.timeoutIds.validations[m.cause]&&clearTimeout(this.timeoutIds.validations[m.cause]),this.timeoutIds.validations[m.cause]=setTimeout(async()=>{if(M.signal.aborted)return L(void 0);try{L(await this.runValidator({validate:m.validate,value:{value:o.store.state.value,fieldApi:o,signal:M.signal,validationSource:"field"},type:"validateAsync"}))}catch(X){j(X)}},m.debounceMs)})}catch(L){y=L}if(M.signal.aborted)return b(void 0);const V=Ge(y),E=(I=a[this.name])==null?void 0:I[v],{newErrorValue:F,newSource:w}=We({formLevelError:E,fieldLevelError:V});o.setMeta(L=>({...L,errorMap:{...L==null?void 0:L.errorMap,[v]:F},errorSourceMap:{...L.errorSourceMap,[v]:w}})),b(F)}))};for(const o of t)o.validate&&h(this,o,c);for(const o of l)o.validate&&h(o.field,o,u);let d=[];(c.length||u.length)&&(d=await Promise.all(c),await Promise.all(u)),this.setMeta(o=>({...o,isValidating:!1}));for(const o of n)o.setMeta(m=>({...m,isValidating:!1}));return d.filter(Boolean)},this.validate=(s,e)=>{var l;if(!this.state.meta.isTouched)return[];const{fieldsErrorMap:t}=e!=null&&e.skipFormValidation?{fieldsErrorMap:{}}:this.form.validateSync(s),{hasErrored:a}=this.validateSync(s,t[this.name]??{});if(a&&!this.options.asyncAlways)return(l=this.getInfo().validationMetaMap[ce(s)])==null||l.lastAbortController.abort(),this.state.meta.errors;const n=e!=null&&e.skipFormValidation?Promise.resolve({}):this.form.validateAsync(s);return this.validateAsync(s,n)},this.handleChange=s=>{this.setValue(s)},this.handleBlur=()=>{this.state.meta.isTouched||this.setMeta(e=>({...e,isTouched:!0})),this.state.meta.isBlurred||this.setMeta(e=>({...e,isBlurred:!0})),this.validate("blur"),this.triggerOnBlurListener()},this.parseValueWithSchema=s=>K.validate({value:this.state.value,validationSource:"field"},s),this.parseValueWithSchemaAsync=s=>K.validateAsync({value:this.state.value,validationSource:"field"},s),this.form=r.form,this.name=r.name,this.timeoutIds={validations:{},listeners:{},formListeners:{}},this.store=new B({deps:[this.form.store],fn:()=>{const s=this.form.getFieldValue(this.name),e=this.form.getFieldMeta(this.name)??{...ve,...r.defaultMeta};return{value:s,meta:e}}}),this.options=r}get state(){return this.store.state}runValidator(r){return et(r.validate)?K[r.type](r.value,r.validate):r.validate(r.value)}setErrorMap(r){this.setMeta(s=>({...s,errorMap:{...s.errorMap,...r}}))}triggerOnBlurListener(){var e,t,a,n,l,c;const r=(e=this.form.options.listeners)==null?void 0:e.onBlurDebounceMs;r&&r>0?(this.timeoutIds.formListeners.blur&&clearTimeout(this.timeoutIds.formListeners.blur),this.timeoutIds.formListeners.blur=setTimeout(()=>{var u,h;(h=(u=this.form.options.listeners)==null?void 0:u.onBlur)==null||h.call(u,{formApi:this.form,fieldApi:this})},r)):(a=(t=this.form.options.listeners)==null?void 0:t.onBlur)==null||a.call(t,{formApi:this.form,fieldApi:this});const s=(n=this.options.listeners)==null?void 0:n.onBlurDebounceMs;s&&s>0?(this.timeoutIds.listeners.blur&&clearTimeout(this.timeoutIds.listeners.blur),this.timeoutIds.listeners.blur=setTimeout(()=>{var u,h;(h=(u=this.options.listeners)==null?void 0:u.onBlur)==null||h.call(u,{value:this.state.value,fieldApi:this})},s)):(c=(l=this.options.listeners)==null?void 0:l.onBlur)==null||c.call(l,{value:this.state.value,fieldApi:this})}triggerOnChangeListener(){var e,t,a,n,l,c;const r=(e=this.form.options.listeners)==null?void 0:e.onChangeDebounceMs;r&&r>0?(this.timeoutIds.formListeners.change&&clearTimeout(this.timeoutIds.formListeners.change),this.timeoutIds.formListeners.change=setTimeout(()=>{var u,h;(h=(u=this.form.options.listeners)==null?void 0:u.onChange)==null||h.call(u,{formApi:this.form,fieldApi:this})},r)):(a=(t=this.form.options.listeners)==null?void 0:t.onChange)==null||a.call(t,{formApi:this.form,fieldApi:this});const s=(n=this.options.listeners)==null?void 0:n.onChangeDebounceMs;s&&s>0?(this.timeoutIds.listeners.change&&clearTimeout(this.timeoutIds.listeners.change),this.timeoutIds.listeners.change=setTimeout(()=>{var u,h;(h=(u=this.options.listeners)==null?void 0:u.onChange)==null||h.call(u,{value:this.state.value,fieldApi:this})},s)):(c=(l=this.options.listeners)==null?void 0:l.onChange)==null||c.call(l,{value:this.state.value,fieldApi:this})}}function Ge(i){if(i)return i}function ce(i){switch(i){case"submit":return"onSubmit";case"blur":return"onBlur";case"mount":return"onMount";case"server":return"onServer";case"dynamic":return"onDynamic";case"change":default:return"onChange"}}var we={exports:{}},Ae={};/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ke;function At(){if(Ke)return Ae;Ke=1;var i=Xe(),r=lt();function s(u,h){return u===h&&(u!==0||1/u===1/h)||u!==u&&h!==h}var e=typeof Object.is=="function"?Object.is:s,t=r.useSyncExternalStore,a=i.useRef,n=i.useEffect,l=i.useMemo,c=i.useDebugValue;return Ae.useSyncExternalStoreWithSelector=function(u,h,d,o,m){var f=a(null);if(f.current===null){var v={hasValue:!1,value:null};f.current=v}else v=f.current;f=l(function(){function M(F){if(!b){if(b=!0,y=F,F=o(F),m!==void 0&&v.hasValue){var w=v.value;if(m(w,F))return V=w}return V=F}if(w=V,e(y,F))return w;var I=o(F);return m!==void 0&&m(w,I)?(y=F,w):(y=F,V=I)}var b=!1,y,V,E=d===void 0?null:d;return[function(){return M(h())},E===null?void 0:function(){return M(E())}]},[h,d,o,m]);var g=t(u,f[0],f[1]);return n(function(){v.hasValue=!0,v.value=g},[g]),c(g),g},Ae}var He;function Lt(){return He||(He=1,we.exports=At()),we.exports}var It=Lt();function tt(i,r=s=>s){return It.useSyncExternalStoreWithSelector(i.subscribe,()=>i.state,()=>i.state,r,_t)}function _t(i,r){if(Object.is(i,r))return!0;if(typeof i!="object"||i===null||typeof r!="object"||r===null)return!1;if(i instanceof Map&&r instanceof Map){if(i.size!==r.size)return!1;for(const[e,t]of i)if(!r.has(e)||!Object.is(t,r.get(e)))return!1;return!0}if(i instanceof Set&&r instanceof Set){if(i.size!==r.size)return!1;for(const e of i)if(!r.has(e))return!1;return!0}if(i instanceof Date&&r instanceof Date)return i.getTime()===r.getTime();const s=Ze(i);if(s.length!==Ze(r).length)return!1;for(let e=0;e<s.length;e++)if(!Object.prototype.hasOwnProperty.call(r,s[e])||!Object.is(i[s[e]],r[s[e]]))return!1;return!0}function Ze(i){return Object.keys(i).concat(Object.getOwnPropertySymbols(i))}const ge=typeof window<"u"?J.useLayoutEffect:J.useEffect;function Dt(i){const[r]=J.useState(()=>{const e=new wt({...i,form:i.form,name:i.name});return e.Field=st,e});return ge(r.mount,[r]),ge(()=>{r.update(i)}),tt(r.store,i.mode==="array"?s=>[s.meta,Object.keys(s.value??[]).length]:void 0),r}const st=(({children:i,...r})=>{const s=Dt(r),e=J.useMemo(()=>Se(i,s),[i,s,s.state.value,s.state.meta]);return A.jsx(A.Fragment,{children:e})});function Tt({form:i,selector:r,children:s}){const e=tt(i.store,r);return Se(s,e)}function Ct(i){const[r]=J.useState(()=>{const s=new Et(i),e=s;return e.Field=function(a){return A.jsx(st,{...a,form:s})},e.Subscribe=function(a){return A.jsx(Tt,{form:s,selector:a.selector,children:a.children})},e});return ge(r.mount,[]),ge(()=>{r.update(i)}),r}const Je=["IngenierÃ­a en BiotecnologÃ­a","IngenierÃ­a de Inteligencia Artificial","IngenierÃ­a de Ciberseguridad","IngenierÃ­a Civil","IngenierÃ­a Ambiental","IngenierÃ­a EstadÃ­stica","IngenierÃ­a ElÃ©ctrica","IngenierÃ­a de Sistemas","AdministraciÃ³n de empresas","MatemÃ¡ticas","IngenierÃ­a MecÃ¡nica","IngenierÃ­a BiomÃ©dica"];function xt(){const[i,r]=J.useState(null),s=it({mutationFn:async t=>{if(await new Promise(a=>setTimeout(a,1e3)),t.code==="1234567890")throw new Error("El cÃ³digo de estudiante ya existe");return{name:t.name,radicado:ut()}},onSuccess:t=>{r({name:t.name,radicado:t.radicado}),e.reset()}}),e=Ct({defaultValues:{code:"",name:"",career:"",email:""},onSubmit:async({value:t})=>{s.mutate(t)}});return A.jsxs("div",{className:"space-y-6",children:[i&&A.jsxs(xe,{color:"success",title:"Estudiante registrado exitosamente",children:["Estudiante: ",i.name," | Radicado: ",i.radicado]}),A.jsxs("form",{onSubmit:t=>{t.preventDefault(),e.handleSubmit()},className:"space-y-4",children:[A.jsx(e.Field,{name:"code",validators:{onChange:({value:t})=>{if(!t)return"CÃ³digo requerido";if(!/^\d{10}$/.test(t))return"Debe ser exactamente 10 dÃ­gitos"}},children:t=>A.jsx(ye,{label:"CÃ³digo de Estudiante",placeholder:"1234567890",value:t.state.value,onChange:a=>t.handleChange(a.target.value),isInvalid:!!t.state.meta.errors.length,errorMessage:t.state.meta.errors[0],maxLength:10,isRequired:!0})}),A.jsx(e.Field,{name:"name",validators:{onChange:({value:t})=>{if(!t)return"Nombre requerido";if(!/^[a-zA-ZÃ¡Ã©Ã­Ã³ÃºÃÃ‰ÃÃ“ÃšÃ±Ã‘\s]+$/.test(t))return"Solo letras y espacios"}},children:t=>A.jsx(ye,{label:"Nombre Completo",placeholder:"Juan PÃ©rez GarcÃ­a",value:t.state.value,onChange:a=>t.handleChange(a.target.value),isInvalid:!!t.state.meta.errors.length,errorMessage:t.state.meta.errors[0],isRequired:!0})}),A.jsx(e.Field,{name:"career",validators:{onChange:({value:t})=>{if(!t)return"Carrera requerida";if(!Je.includes(t))return"Carrera no vÃ¡lida"}},children:t=>A.jsx(rt,{label:"Carrera",placeholder:"Selecciona una carrera",selectedKeys:t.state.value?[t.state.value]:[],onSelectionChange:a=>{const n=Array.from(a)[0];t.handleChange(n)},isInvalid:!!t.state.meta.errors.length,errorMessage:t.state.meta.errors[0],isRequired:!0,children:Je.map(a=>A.jsx(at,{className:"text-default-900",children:a},a))})}),A.jsx(e.Field,{name:"email",validators:{onChange:({value:t})=>{if(!t)return"Correo requerido";if(!/^[a-zA-Z]+\.[a-zA-Z]+@escuelaing\.edu\.co$/.test(t))return"Formato: nombre.apellido@escuelaing.edu.co"}},children:t=>A.jsx(ye,{label:"Correo Institucional",placeholder:"juan.perez@escuelaing.edu.co",value:t.state.value,onChange:a=>t.handleChange(a.target.value),isInvalid:!!t.state.meta.errors.length,errorMessage:t.state.meta.errors[0],isRequired:!0})}),A.jsx(nt,{type:"submit",color:"primary",isLoading:s.isPending,className:"w-full",children:"Registrar Estudiante"}),s.error&&A.jsx(xe,{color:"danger",title:"Error al registrar",children:s.error.message})]})]})}export{xt as S,zt as m,Ct as u};
