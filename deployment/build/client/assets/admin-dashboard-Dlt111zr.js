import{b as A,t as e,w as Y,R as J}from"./index-BozS7dwg.js";import{A as W}from"./academic-semaphore-B3mugncz.js";import{u as X,S as Z}from"./student-registration-B-iTyGcQ.js";import{u as $,t as _,a as z,b as d,c as P,d as R,e as o,s as ee}from"./useQuery-BCrtMYGT.js";import{u as ae}from"./QueryClientProvider-C9Cpl-59.js";import{u as F,d as se}from"./useMutation-D7hWThM1.js";import{u as te,m as re,a as ne,b as ie,c as le,d as ce,S as de}from"./sidebar-DE08m5e8.js";import{c as j,b,d as f,e as E}from"./chunk-ICU6NNET-Bz7BzOns.js";import{b as u}from"./chunk-WBUKVQRU-D83Npybh.js";import{c as v}from"./chunk-XJ2YRSUP-CDLwH12k.js";import{i as D}from"./chunk-SSA7SXE4-L4GPux4n.js";import{R as oe}from"./role-management-CvnvGvDc.js";import"./filter-props-w36Z9eCG.js";import"./useModal-Co5K6ijZ.js";import"./index-BkE0-fgG.js";import"./global-config-B5DaTUF1.js";import"./query-Pcq8wdku.js";import"./index-DrMVgKsE.js";const C=[{id:"1",name:"2024-1",startDate:"2024-02-01",endDate:"2024-06-30",status:"cerrado"},{id:"2",name:"2024-2",startDate:"2024-08-01",endDate:"2024-12-15",status:"activo"},{id:"3",name:"2025-1",startDate:"2025-02-01",endDate:"2025-06-30",status:"futuro"}];function me({userRole:s="ADMIN"}){console.log("User role:",s);const{isOpen:i,onOpen:l,onClose:r}=te(),[n,p]=A.useState(null),[t,S]=A.useState(null),I=ae(),{data:M=[],isLoading:L}=$({queryKey:["academic-periods"],queryFn:async()=>(await new Promise(a=>setTimeout(a,500)),C)}),w=F({mutationFn:async a=>{if(await new Promise(m=>setTimeout(m,1e3)),C.find(m=>m.name===a.name&&m.id!==a.id))throw new Error("Ya existe un período con ese nombre");if(new Date(a.startDate)>=new Date(a.endDate))throw new Error("La fecha de inicio debe ser anterior a la fecha de fin");if(C.some(m=>{if(m.id===a.id)return!1;const y=new Date(m.startDate+"T00:00:00"),H=new Date(m.endDate+"T23:59:59"),U=new Date(a.startDate+"T00:00:00"),Q=new Date(a.endDate+"T23:59:59");return U<H&&Q>y}))throw new Error("Las fechas se solapan con otro período existente");return a},onSuccess:()=>{I.invalidateQueries({queryKey:["academic-periods"]}),r(),p(null)}}),T=F({mutationFn:async a=>(await new Promise(c=>setTimeout(c,500)),a),onSuccess:()=>{I.invalidateQueries({queryKey:["academic-periods"]}),S(null)}}),x=X({defaultValues:{name:(n==null?void 0:n.name)||"",startDate:(n==null?void 0:n.startDate)||"",endDate:(n==null?void 0:n.endDate)||""},onSubmit:async({value:a})=>{const c={...a,id:n==null?void 0:n.id,status:k(a.startDate,a.endDate)};w.mutate(c)}}),k=(a,c)=>{const h=new Date,m=new Date(a),y=new Date(c);return h<m?"futuro":h>y?"cerrado":"activo"},q=a=>{switch(a){case"activo":return"success";case"cerrado":return"default";case"futuro":return"primary";default:return"default"}},V=a=>{switch(a){case"activo":return"Activo";case"cerrado":return"Cerrado";case"futuro":return"Futuro";default:return a}},G=a=>{p(a),x.setFieldValue("name",a.name),x.setFieldValue("startDate",a.startDate),x.setFieldValue("endDate",a.endDate),l()},K=()=>{p(null),x.reset(),l()},B=a=>{t===a?T.mutate(a):S(a)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(j,{children:[e.jsxs(b,{className:"flex justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Períodos Académicos"}),e.jsx("p",{className:"text-sm text-default-500",children:"Gestión de períodos académicos del sistema"})]}),e.jsx(u,{color:"primary",onPress:K,children:"Nuevo Período"})]}),e.jsx(f,{children:e.jsxs(_,{"aria-label":"Tabla de períodos académicos",children:[e.jsxs(z,{children:[e.jsx(d,{children:"NOMBRE"}),e.jsx(d,{children:"FECHA INICIO"}),e.jsx(d,{children:"FECHA FIN"}),e.jsx(d,{children:"ESTADO"}),e.jsx(d,{children:"ACCIONES"})]}),e.jsx(P,{isLoading:L,children:M.map(a=>e.jsxs(R,{children:[e.jsx(o,{className:"font-medium",children:a.name}),e.jsx(o,{children:new Date(a.startDate).toLocaleDateString()}),e.jsx(o,{children:new Date(a.endDate).toLocaleDateString()}),e.jsx(o,{children:e.jsx(v,{color:q(a.status),variant:"flat",children:V(a.status)})}),e.jsx(o,{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(u,{size:"sm",variant:"light",color:"primary",onPress:()=>G(a),children:"Editar"}),e.jsx(u,{size:"sm",variant:"light",color:"danger",onPress:()=>B(a.id),children:t===a.id?"Confirmar":"Eliminar"}),t===a.id&&e.jsx(u,{size:"sm",variant:"light",onPress:()=>S(null),children:"Cancelar"})]})})]},a.id))})]})})]}),e.jsx(re,{isOpen:i,onClose:r,size:"lg",children:e.jsx(ne,{children:e.jsxs("form",{onSubmit:a=>{a.preventDefault(),x.handleSubmit()},children:[e.jsx(ie,{children:n?"Editar Período":"Nuevo Período"}),e.jsxs(le,{className:"space-y-4",children:[w.error&&e.jsx(se,{color:"danger",title:"Error",children:w.error.message}),e.jsx(x.Field,{name:"name",validators:{onChange:({value:a})=>{if(!a)return"Nombre requerido";if(a.length<3)return"Mínimo 3 caracteres"}},children:a=>e.jsx(D,{label:"Nombre del Período",placeholder:"Ej: 2024-1",value:a.state.value,onChange:c=>a.handleChange(c.target.value),isInvalid:!!a.state.meta.errors.length,errorMessage:a.state.meta.errors[0],isRequired:!0})}),e.jsx(x.Field,{name:"startDate",validators:{onChange:({value:a})=>{if(!a)return"Fecha de inicio requerida"}},children:a=>e.jsx(D,{type:"date",label:"Fecha de Inicio",value:a.state.value,onChange:c=>a.handleChange(c.target.value),isInvalid:!!a.state.meta.errors.length,errorMessage:a.state.meta.errors[0],isRequired:!0})}),e.jsx(x.Field,{name:"endDate",validators:{onChange:({value:a,fieldApi:c})=>{if(!a)return"Fecha de fin requerida";const h=c.form.getFieldValue("startDate");if(h&&new Date(a)<=new Date(h))return"La fecha de fin debe ser posterior a la fecha de inicio"}},children:a=>e.jsx(D,{type:"date",label:"Fecha de Fin",value:a.state.value,onChange:c=>a.handleChange(c.target.value),isInvalid:!!a.state.meta.errors.length,errorMessage:a.state.meta.errors[0],isRequired:!0})})]}),e.jsxs(ce,{children:[e.jsx(u,{variant:"light",onPress:r,children:"Cancelar"}),e.jsx(u,{color:"primary",type:"submit",isLoading:w.isPending,children:n?"Actualizar":"Crear"})]})]})})})]})}const ue=[{id:"1",name:"Juan Pérez García",email:"juan.perez@escuelaing.edu.co",code:"1234567890",program:"Ingeniería de Sistemas",status:"activo"},{id:"2",name:"María González López",email:"maria.gonzalez@escuelaing.edu.co",code:"1234567891",program:"Ingeniería Civil",status:"activo"},{id:"3",name:"Carlos Rodríguez Silva",email:"carlos.rodriguez@escuelaing.edu.co",code:"1234567892",program:"Ingeniería de Sistemas",status:"activo"},{id:"4",name:"Ana Martínez Torres",email:"ana.martinez@escuelaing.edu.co",code:"1234567893",program:"Ingeniería Biomédica",status:"graduado"}];function xe({onSelectStudent:s}){const[i,l]=A.useState(""),r=ue.filter(t=>t.name.toLowerCase().includes(i.toLowerCase())||t.email.toLowerCase().includes(i.toLowerCase())||t.code.includes(i)),n=t=>{switch(t){case"activo":return"success";case"inactivo":return"warning";case"graduado":return"primary";default:return"default"}},p=t=>{switch(t){case"activo":return"Activo";case"inactivo":return"Inactivo";case"graduado":return"Graduado";default:return t}};return e.jsxs(j,{children:[e.jsx(b,{children:e.jsxs("div",{className:"w-full",children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Seleccionar Estudiante"}),e.jsx("p",{className:"text-sm text-default-600 mb-4",children:"Selecciona un estudiante para ver su progreso académico"}),e.jsx(D,{placeholder:"Buscar por nombre, email o código...",value:i,onChange:t=>l(t.target.value),className:"max-w-sm"})]})}),e.jsx(f,{children:e.jsxs(_,{"aria-label":"Tabla de estudiantes",children:[e.jsxs(z,{children:[e.jsx(d,{children:"NOMBRE"}),e.jsx(d,{children:"CÓDIGO"}),e.jsx(d,{children:"PROGRAMA"}),e.jsx(d,{children:"ESTADO"}),e.jsx(d,{children:"ACCIONES"})]}),e.jsx(P,{children:r.map(t=>e.jsxs(R,{children:[e.jsx(o,{children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:t.name}),e.jsx("p",{className:"text-xs text-default-500",children:t.email})]})}),e.jsx(o,{children:t.code}),e.jsx(o,{children:t.program}),e.jsx(o,{children:e.jsx(v,{color:n(t.status),variant:"flat",size:"sm",children:p(t.status)})}),e.jsx(o,{children:e.jsx(u,{size:"sm",color:"primary",variant:"flat",onPress:()=>s(t),children:"Ver Progreso"})})]},t.id))})]})})]})}const O={id:"admin-1",name:"Administrador General",email:"admin@sirha.edu",role:"admin"};function he(s="dashboard"){const[i,l]=J.useState(s);return{view:i,navigate:n=>l(n)}}function je(...s){return s.filter(Boolean).join(" ")}const N=({title:s,value:i,color:l="primary",note:r})=>{const n=l==="primary"?"text-primary":l==="secondary"?"text-secondary":l==="success"?"text-success":l==="warning"?"text-warning":l==="danger"?"text-danger":"text-default-700";return e.jsx(j,{className:"min-w-[160px] flex-1",radius:"sm",shadow:"sm",children:e.jsxs(f,{className:"gap-1 py-4",children:[e.jsx("p",{className:"text-xs text-default-500 font-medium tracking-wide uppercase",children:s}),e.jsx("p",{className:je("text-2xl font-semibold",n),children:i}),r&&e.jsx("p",{className:"text-[11px] text-default-400",children:r})]})})},fe=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsx(N,{title:"Usuarios",value:428,note:"Activos este mes"}),e.jsx(N,{title:"Solicitudes",value:73,color:"secondary",note:"Pendientes de revisión"}),e.jsx(N,{title:"Aprobadas",value:58,color:"success",note:"Últimos 7 días"}),e.jsx(N,{title:"Rechazadas",value:15,color:"danger",note:"Últimos 7 días"})]}),e.jsxs(j,{shadow:"sm",radius:"sm",children:[e.jsxs(b,{className:"flex flex-col items-start gap-1",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Actividad reciente"}),e.jsx("p",{className:"text-xs text-default-500",children:"Resumen de las últimas acciones del sistema"})]}),e.jsx(E,{}),e.jsx(f,{className:"overflow-x-auto",children:e.jsxs(_,{"aria-label":"Actividad reciente",removeWrapper:!0,className:"min-w-[560px]",children:[e.jsxs(z,{children:[e.jsx(d,{children:"FECHA"}),e.jsx(d,{children:"ACCIÓN"}),e.jsx(d,{children:"USUARIO"}),e.jsx(d,{children:"ESTADO"})]}),e.jsx(P,{children:[{id:"a1",d:"2025-09-20 09:12",act:"Registro estudiante",u:"mperez",s:"OK"},{id:"a2",d:"2025-09-20 09:30",act:"Cambio rol",u:"admin",s:"OK"},{id:"a3",d:"2025-09-20 10:05",act:"Solicitud sala",u:"lrojas",s:"Pendiente"},{id:"a4",d:"2025-09-20 10:18",act:"Solicitud equipo deportivo",u:"jdiaz",s:"Rechazada"}].map(s=>e.jsxs(R,{children:[e.jsx(o,{className:"text-xs",children:s.d}),e.jsx(o,{className:"text-sm font-medium",children:s.act}),e.jsx(o,{className:"text-xs text-default-500",children:s.u}),e.jsxs(o,{children:[s.s==="OK"&&e.jsx(v,{size:"sm",color:"success",variant:"flat",children:s.s}),s.s==="Pendiente"&&e.jsx(v,{size:"sm",color:"warning",variant:"flat",children:s.s}),s.s==="Rechazada"&&e.jsx(v,{size:"sm",color:"danger",variant:"flat",children:s.s})]})]},s.id))})]})})]})]}),pe=({user:s})=>e.jsxs(j,{radius:"sm",shadow:"sm",children:[e.jsx(b,{children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Perfil"}),e.jsx("p",{className:"text-xs text-default-500",children:"Información básica del administrador"})]})}),e.jsx(E,{}),e.jsxs(f,{className:"space-y-2 text-sm",children:[e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Nombre:"})," ",s.name]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Correo:"})," ",s.email]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Rol:"})," ",s.role]}),e.jsx(u,{size:"sm",color:"primary",variant:"flat",className:"mt-2 w-fit",children:"Editar perfil"})]})]}),g=({title:s,description:i})=>e.jsxs(j,{radius:"sm",shadow:"sm",children:[e.jsx(b,{children:e.jsx("h2",{className:"text-lg font-semibold",children:s})}),e.jsx(E,{}),e.jsx(f,{children:e.jsx("p",{className:"text-sm text-default-600",children:i||"Sección en construcción. Próximamente funcionalidades completas."})})]}),Me=Y(function(){const{view:i,navigate:l}=he("dashboard");let r;switch(i){case"dashboard":r=e.jsx(fe,{});break;case"role-management":r=e.jsx(oe,{});break;case"student-registration":r=e.jsx(Z,{});break;case"profile":r=e.jsx(pe,{user:O});break;case"requests":r=e.jsx(g,{title:"Solicitudes",description:"Listado y gestión de solicitudes entrantes."});break;case"create-request":r=e.jsx(g,{title:"Nueva Solicitud",description:"Formulario para creación manual de solicitud."});break;case"management":r=e.jsx(g,{title:"Gestión",description:"Panel centralizado de operaciones administrativas."});break;case"reports":r=e.jsx(g,{title:"Reportes",description:"Generación y descarga de reportes analíticos."});break;case"academic-progress":r=e.jsxs("div",{className:"space-y-6",children:[e.jsx(xe,{onSelectStudent:n=>{console.log("Selected student:",n)}}),e.jsx(W,{userRole:"ADMIN",studentId:"admin-view",targetStudentId:"1234567890"})]});break;case"academic-plan":r=e.jsx(me,{userRole:"ADMIN"});break;default:r=e.jsx(g,{title:"Vista"})}return e.jsxs("div",{className:"flex h-dvh w-dvw bg-content2 text-content2-foreground",children:[e.jsx(de,{user:O,currentView:i,onNavigate:l}),e.jsx("main",{className:"flex-1 h-full overflow-y-auto p-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("header",{className:"flex flex-col gap-2 mb-6 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-semibold tracking-tight",children:i==="dashboard"?"Panel Administrativo":i.replace("-"," ")}),e.jsx("p",{className:"text-xs text-default-500",children:i==="dashboard"?"Resumen general del sistema y métricas principales.":"Gestión de la sección seleccionada."})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(u,{size:"sm",variant:"flat",color:"secondary",onPress:()=>l("dashboard"),children:"Inicio"}),e.jsx(u,{size:"sm",variant:"flat",color:"primary",onPress:()=>l("reports"),children:"Reportes"})]})]}),r,e.jsx(ee,{y:12}),e.jsxs("footer",{className:"pt-8 pb-6 text-center text-[11px] text-default-400",children:["SIRHA · Dashboard Administrativo ·"," ",new Date().getFullYear()]})]})})]})});export{Me as default};
